<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PT Management System</title>
    <style>
        /* Existing styles (unchanged) */
        /* ... truncated for brevity ... */
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèãÔ∏è PT Management System</h1>
            <p>Streamline your unit's physical training coordination</p>
        </div>

        <div class="main-content">
            <div class="alert alert-info">
                <strong>üí° Quick Start:</strong> Add your unit members, select a PT leader, generate or select a workout, mark attendance, and generate your report to copy into Teams!
            </div>

            <!-- Unit Setup Section -->
            <div class="section">
                <h2>üë• Unit Setup</h2>
                <div class="form-group">
                    <label for="unitName">Unit Name:</label>
                    <input type="text" id="unitName" value="73 ISRS Det 6" readonly>
                </div>
                <div class="form-group">
                    <label for="memberFile">Upload Member List (CSV/TXT):</label>
                    <input type="file" id="memberFile" accept=".csv,.txt" onchange="uploadMemberList()">
                    <small>Upload one name per line, optionally comma-separated with PT</small>
                </div>
                <div class="form-group">
                    <label for="newMember">Add Unit Member:</label>
                    <input type="text" id="newMember" placeholder="Enter member name">
                    <label><input type="checkbox" id="isPTLeader"> PT Leader</label>
                    <button class="btn" onclick="addMember()">Add Member</button>
                </div>
                <div class="form-group">
                    <h3>Current Members:</h3>
                    <div id="memberManagement"></div>
                </div>
            </div>

            <!-- PT Assignment Section -->
            <div class="section">
                <h2>üéØ PT Assignment</h2>
                <div class="form-group">
                    <label for="ptDate">PT Date:</label>
                    <input type="date" id="ptDate">
                </div>
                <div class="form-group">
                    <label for="ptLeader">PT Leader:</label>
                    <select id="ptLeader"><option value="">Select PT Leader</option></select>
                    <button class="btn" onclick="assignRandomLeader()">Random Assignment</button>
                </div>
                <div class="form-group">
                    <label for="ptLocation">Location:</label>
                    <select id="ptLocation">
                        <option value="Gaffney Gym">Gaffney Gym</option>
                        <option value="Eagle Fitness">Eagle Fitness</option>
                        <option value="Parade Field">Parade Field</option>
                        <option value="custom">Other (Custom)</option>
                    </select>
                    <input type="text" id="customLocation" placeholder="Enter custom location" style="display:none; margin-top:10px;">
                </div>
                <div class="form-group">
                    <label for="ptTime">Time:</label>
                    <input type="time" id="ptTime" value="06:30">
                </div>
            </div>

            <!-- Additional Sections Unchanged -->
            <!-- ... Workout Management, Attendance, Report Generation ... -->
        </div>
    </div>

    <script>
        let members = [];

        function init() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('ptDate').value = today;
            document.getElementById('ptLocation').addEventListener('change', function () {
                const custom = document.getElementById('customLocation');
                custom.style.display = this.value === 'custom' ? 'block' : 'none';
            });
            loadData();
            updateUI();
        }

        function addMember() {
            const name = document.getElementById('newMember').value.trim();
            const isPTLeader = document.getElementById('isPTLeader').checked;
            if (name && !members.some(m => m.name === name)) {
                members.push({ name, isPTLeader });
                saveData();
                updateUI();
            }
        }

        function uploadMemberList() {
            const file = document.getElementById('memberFile').files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function (e) {
                const lines = e.target.result.split('\n');
                lines.forEach(line => {
                    const [name, tag] = line.split(',').map(x => x.trim());
                    if (name && !members.some(m => m.name === name)) {
                        members.push({ name, isPTLeader: tag?.toLowerCase() === 'pt' });
                    }
                });
                saveData();
                updateUI();
            };
            reader.readAsText(file);
        }

        function assignRandomLeader() {
            const ptLeaders = members.filter(m => m.isPTLeader);
            if (ptLeaders.length === 0) return;
            const random = ptLeaders[Math.floor(Math.random() * ptLeaders.length)];
            document.getElementById('ptLeader').value = random.name;
        }

        function updateUI() {
            const leaderSelect = document.getElementById('ptLeader');
            const listDiv = document.getElementById('memberManagement');
            leaderSelect.innerHTML = '<option value="">Select PT Leader</option>';
            listDiv.innerHTML = '';
            members.forEach(({ name, isPTLeader }) => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                if (isPTLeader) leaderSelect.appendChild(option);
                const div = document.createElement('div');
                div.textContent = name + (isPTLeader ? ' ‚≠ê' : '');
                listDiv.appendChild(div);
            });
        }

        function saveData() {
            localStorage.setItem('ptMembers', JSON.stringify(members));
        }

        function loadData() {
            const data = localStorage.getItem('ptMembers');
            if (data) members = JSON.parse(data);
        }

        window.onload = init;
    </script>
</body>
</html>
